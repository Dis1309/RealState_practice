<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
     <div class="container">
         <h1>Seller</h1>
        <form id="forms">
            <h1>personal info</h1>
                <label for="email">Enter youe email id<br><input type="email" id="email"></label><br>
                <label for="phone_num">Enter your phone number<br><input type="text" id="phone_num"></label><br>

                <h1>Propertydetails</h1>
                <label for="address">enter the location<br><input type="text" id="address"></label><br>
                <label for="area">Area of property<br><input type="text" id="area"></label><br>
                <label for="price">Enter the price <br><input type="number" id="price"></label><br> 
                <!-- <input type="file" id="imageInput">
              <div id="display_image"></div> -->
                <label><input type="submit" id="submit_btn"placeholder="submit"></label>
                <script
        src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js"
        type="application/javascript"></script>
        <script>
            let obj = {};let arr = [];let r=0;
            const submit_btn = document.querySelector("#submit_btn");
const form = document.forms["forms"];
submit_btn.addEventListener("click", (e) =>{
  r++;
    const address=document.querySelector("#address").value;

const price=document.querySelector("#price").value;

const area = document.querySelector("#area").value;
obj.address = address;
    obj.price=price;
    obj.area=area;
    arr.push(obj);
    e.preventDefault();
        console.log(obj);
            const RealEstate = [
            {
              "inputs": [],
              "stateMutability": "nonpayable",
              "type": "constructor"
            },
            {
              "anonymous": false,
              "inputs": [
                {
                  "indexed": true,
                  "internalType": "address",
                  "name": "owner",
                  "type": "address"
                },
                {
                  "indexed": true,
                  "internalType": "address",
                  "name": "approved",
                  "type": "address"
                },
                {
                  "indexed": true,
                  "internalType": "uint256",
                  "name": "tokenId",
                  "type": "uint256"
                }
              ],
              "name": "Approval",
              "type": "event"
            },
            {
              "anonymous": false,
              "inputs": [
                {
                  "indexed": true,
                  "internalType": "address",
                  "name": "owner",
                  "type": "address"
                },
                {
                  "indexed": true,
                  "internalType": "address",
                  "name": "operator",
                  "type": "address"
                },
                {
                  "indexed": false,
                  "internalType": "bool",
                  "name": "approved",
                  "type": "bool"
                }
              ],
              "name": "ApprovalForAll",
              "type": "event"
            },
            {
              "anonymous": false,
              "inputs": [
                {
                  "indexed": true,
                  "internalType": "address",
                  "name": "from",
                  "type": "address"
                },
                {
                  "indexed": true,
                  "internalType": "address",
                  "name": "to",
                  "type": "address"
                },
                {
                  "indexed": true,
                  "internalType": "uint256",
                  "name": "tokenId",
                  "type": "uint256"
                }
              ],
              "name": "Transfer",
              "type": "event"
            },
            {
              "inputs": [
                {
                  "internalType": "address",
                  "name": "to",
                  "type": "address"
                },
                {
                  "internalType": "uint256",
                  "name": "tokenId",
                  "type": "uint256"
                }
              ],
              "name": "approve",
              "outputs": [],
              "stateMutability": "nonpayable",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "address",
                  "name": "owner",
                  "type": "address"
                }
              ],
              "name": "balanceOf",
              "outputs": [
                {
                  "internalType": "uint256",
                  "name": "",
                  "type": "uint256"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "tokenId",
                  "type": "uint256"
                }
              ],
              "name": "getApproved",
              "outputs": [
                {
                  "internalType": "address",
                  "name": "",
                  "type": "address"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "address",
                  "name": "owner",
                  "type": "address"
                },
                {
                  "internalType": "address",
                  "name": "operator",
                  "type": "address"
                }
              ],
              "name": "isApprovedForAll",
              "outputs": [
                {
                  "internalType": "bool",
                  "name": "",
                  "type": "bool"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "string",
                  "name": "tokenURI",
                  "type": "string"
                }
              ],
              "name": "mint",
              "outputs": [
                {
                  "internalType": "uint256",
                  "name": "",
                  "type": "uint256"
                }
              ],
              "stateMutability": "nonpayable",
              "type": "function"
            },
            {
              "inputs": [],
              "name": "name",
              "outputs": [
                {
                  "internalType": "string",
                  "name": "",
                  "type": "string"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "tokenId",
                  "type": "uint256"
                }
              ],
              "name": "ownerOf",
              "outputs": [
                {
                  "internalType": "address",
                  "name": "",
                  "type": "address"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "address",
                  "name": "from",
                  "type": "address"
                },
                {
                  "internalType": "address",
                  "name": "to",
                  "type": "address"
                },
                {
                  "internalType": "uint256",
                  "name": "tokenId",
                  "type": "uint256"
                }
              ],
              "name": "safeTransferFrom",
              "outputs": [],
              "stateMutability": "nonpayable",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "address",
                  "name": "from",
                  "type": "address"
                },
                {
                  "internalType": "address",
                  "name": "to",
                  "type": "address"
                },
                {
                  "internalType": "uint256",
                  "name": "tokenId",
                  "type": "uint256"
                },
                {
                  "internalType": "bytes",
                  "name": "data",
                  "type": "bytes"
                }
              ],
              "name": "safeTransferFrom",
              "outputs": [],
              "stateMutability": "nonpayable",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "address",
                  "name": "operator",
                  "type": "address"
                },
                {
                  "internalType": "bool",
                  "name": "approved",
                  "type": "bool"
                }
              ],
              "name": "setApprovalForAll",
              "outputs": [],
              "stateMutability": "nonpayable",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "bytes4",
                  "name": "interfaceId",
                  "type": "bytes4"
                }
              ],
              "name": "supportsInterface",
              "outputs": [
                {
                  "internalType": "bool",
                  "name": "",
                  "type": "bool"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [],
              "name": "symbol",
              "outputs": [
                {
                  "internalType": "string",
                  "name": "",
                  "type": "string"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "tokenId",
                  "type": "uint256"
                }
              ],
              "name": "tokenURI",
              "outputs": [
                {
                  "internalType": "string",
                  "name": "",
                  "type": "string"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [],
              "name": "totalSupply",
              "outputs": [
                {
                  "internalType": "uint256",
                  "name": "",
                  "type": "uint256"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "address",
                  "name": "from",
                  "type": "address"
                },
                {
                  "internalType": "address",
                  "name": "to",
                  "type": "address"
                },
                {
                  "internalType": "uint256",
                  "name": "tokenId",
                  "type": "uint256"
                }
              ],
              "name": "transferFrom",
              "outputs": [],
              "stateMutability": "nonpayable",
              "type": "function"
            }
          ];
            const Contract = [
            {
              "inputs": [
                {
                  "internalType": "address",
                  "name": "_nftaddress",
                  "type": "address"
                },
                {
                  "internalType": "address payable",
                  "name": "_seller",
                  "type": "address"
                }
              ],
              "stateMutability": "nonpayable",
              "type": "constructor"
            },
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "_nftID",
                  "type": "uint256"
                }
              ],
              "name": "bought",
              "outputs": [],
              "stateMutability": "payable",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "",
                  "type": "uint256"
                }
              ],
              "name": "buyer",
              "outputs": [
                {
                  "internalType": "address",
                  "name": "",
                  "type": "address"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "_nftID",
                  "type": "uint256"
                },
                {
                  "internalType": "address",
                  "name": "_buyer",
                  "type": "address"
                }
              ],
              "name": "declareBuyer",
              "outputs": [],
              "stateMutability": "nonpayable",
              "type": "function"
            },
            {
              "inputs": [],
              "name": "getBalance",
              "outputs": [
                {
                  "internalType": "uint256",
                  "name": "",
                  "type": "uint256"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "",
                  "type": "uint256"
                }
              ],
              "name": "isListed",
              "outputs": [
                {
                  "internalType": "bool",
                  "name": "",
                  "type": "bool"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "_nftID",
                  "type": "uint256"
                },
                {
                  "internalType": "uint256",
                  "name": "_purchasePrice",
                  "type": "uint256"
                }
              ],
              "name": "list",
              "outputs": [],
              "stateMutability": "payable",
              "type": "function"
            },
            {
              "inputs": [],
              "name": "nftaddress",
              "outputs": [
                {
                  "internalType": "address",
                  "name": "",
                  "type": "address"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [
                {
                  "internalType": "uint256",
                  "name": "",
                  "type": "uint256"
                }
              ],
              "name": "purchasePrice",
              "outputs": [
                {
                  "internalType": "uint256",
                  "name": "",
                  "type": "uint256"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "inputs": [],
              "name": "seller",
              "outputs": [
                {
                  "internalType": "address payable",
                  "name": "",
                  "type": "address"
                }
              ],
              "stateMutability": "view",
              "type": "function"
            },
            {
              "stateMutability": "payable",
              "type": "receive"
            }
          ];
            const chainId = 31337;
            const reladd ="0x5FbDB2315678afecb367f032d93F642f64180aa3"
            const conadd ="0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512"
            async function hello(){
            const provider = new ethers.providers.Web3Provider(window.ethereum);
            const network = await provider.getNetwork();
            await provider.send("eth_requestAccounts", []); 
            const signer = await provider.listAccounts();
            const seller = signer[0];
            console.log(seller);
            // fetch contract
            const realEstate = new ethers.Contract(reladd, RealEstate, provider);
            //const totalSupply = await realEstate.totalSupply(); 
            const con = new ethers.Contract(conadd, Contract, provider);
            console.log(con);
            await con.methods.list(r,price,address,area,price).send({from: seller});
            // console.log(network.chainId); 
            // transaction.wait();
            //transaction = await realEstate.connect(seller).approve(con.address,r);
            //await transaction.wait();
            //await seller.sendTransaction({ to: con.address, value: 5000, gasLimit: 60000 })
            //await provider.send('eth_sendTransaction',[
            // seller,con.address,conadd,12,900
            //])
            //transaction = await con.connect(seller).list(r,arr[r-1].price,arr[r-1].email,arr[r-1].address,arr[r-1].area);
            //await transaction.wait();
            //console.log(r);
            }
            hello();
        }
    
        )
           
        </script>
                <!-- <script type="module" src="./seller.js"></script> -->
                
               <!--<button type="submit">SUBMIT</button> -->
              <!-- <form mathod="post" action="gfg.php">
                <label for="name">Name</label>
                <input type="text" name="name" id="name" />
                <br>
                <label for="phone_no" name="phone_no">Phone no</label><input type="text" id="phone_num">
                <br>
                <label for="email">Email</label>
                <input type="email" name="email" id="email" />
              
                <button type="submit" name="submit">Submit</button> -->
              </form>
              <!-- <script type ="module" src="https://cdn.jsdelivr.net/npm/ipfs/dist/index.min.js"></script> -->
              
              <!-- <script>
                  /********DISPLAYING IMAGE IN A BOX********/
                  const imageInput= document.getElementById("imageInput");
                  var uploaded_image="";
                  imageInput.addEventListener("change",function(){
                      const reader=new FileReader();
                      reader.addEventListener("load",()=>{
                          uploaded_image=reader.result;
                          document.querySelector("#display_image").style.backgroundImage=`url(${uploaded_image})`;
                      });
                      reader.readAsDataURL(this.files[0]);
                  });
              </script> -->
            <!-- </form> -->
            <!-- <?php
    
    if ($_SERVER['REQUEST_METHOD'] == 'POST') {
          
        function get_data() {
            $datae = array();
            $datae[] = array(
                'Name' => $_POST['name'],
                'Branch' => $_POST['phone_no'],
                'College' => $_POST['email'],
            );
            return json_encode($datae);
        }
          
        $name = "gfg";
        $file_name = $name . '.json';
       
        if(file_put_contents(
            "$file_name", get_data())) {
                echo $file_name .' file created';
            }
        else {
            echo 'There is some error';
        }
        console.log($file_name)
    }
    ?> -->
    </div>
    <!-- <script type="module" src="./ipfs-http-client/src/index.js"></script> -->
</body>
</html>